(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[879],{2327:(e,t,s)=>{"use strict";s.d(t,{Me:()=>c,R2:()=>d,eM:()=>g,ic:()=>h,lu:()=>u,qT:()=>l,u5:()=>a,vS:()=>m});let r="https://ai-singer-studio-production.ivanleejackson.workers.dev";class a extends Error{constructor(e,t,s){super(e),this.status=t,this.data=s,this.name="APIClientError"}}function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Set;if("string"==typeof e)return e;if(!e)return"Request failed";if("object"==typeof e&&t.has(e))return"Request failed (circular reference)";if("object"==typeof e&&t.add(e),"string"==typeof e.message)return e.message;if("string"==typeof e.error)return e.error;if("string"==typeof e.error_description)return e.error_description;if("string"==typeof e.detail)return e.detail;if(Array.isArray(e.errors)){let t=e.errors.map(e=>e.message||e.error||"Unknown error").filter(e=>"string"==typeof e);if(t.length>0)return t.join(", ")}if(Array.isArray(e.issues))return e.issues.map(e=>e.message?e.message:Array.isArray(e.path)&&e.path.length?"".concat(e.path.join("."),": ").concat(e.message||"Invalid value"):"Validation error").join(", ");if(Array.isArray(e)){let s=e.map(e=>"string"==typeof e?e:i(e,t)).filter(e=>e&&"Request failed"!==e);if(s.length>0)return s.join(", ")}if("object"==typeof e.error&&null!==e.error)return i(e.error,t);if("object"==typeof e.message&&null!==e.message)return i(e.message,t);if(e.details)return"string"==typeof e.details?e.details:JSON.stringify(e.details);try{let t=JSON.stringify(e);return t.length>200?t.substring(0,200)+"...":t}catch(e){return"Request failed"}}function n(){let e=localStorage.getItem("token")||localStorage.getItem("authToken")||sessionStorage.getItem("token");return console.log("[API Client] Token found:",!!e),e}async function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=n(),o={"Content-Type":"application/json",...t.headers};s&&(o.Authorization="Bearer ".concat(s));let l="".concat(r).concat(e);console.log("[API Client] Request:",t.method||"GET",l);try{let e,s=await fetch(l,{...t,headers:o,credentials:"include"}),r=s.headers.get("content-type"),n=await s.text();if(n)if((null==r?void 0:r.includes("application/json"))||n.trim().startsWith("{")||n.trim().startsWith("["))try{e=JSON.parse(n)}catch(t){e={message:n}}else e={message:n};else e=null;if(!s.ok)throw console.error("[API Client] Error response:",{status:s.status,contentType:r,data:e}),new a(e?i(e):"Request failed with status ".concat(s.status),s.status,e);return console.log("[API Client] Success:",e),e}catch(e){if(e instanceof a)throw e;throw console.error("[API Client] Network error:",e),new a(e instanceof Error?e.message:"Network error occurred")}}let l={async listVoices(e){let t=e?"?category=".concat(encodeURIComponent(e)):"";return o("/api/voices/elevenlabs".concat(t))},getVoice:async e=>o("/api/voices/elevenlabs/".concat(e)),generateVoice:async e=>(console.log("[API Client] Generating voice with params:",e),o("/api/voices/elevenlabs/generate",{method:"POST",body:JSON.stringify(e)})),async cloneVoice(e){let t=n(),s={};t&&(s.Authorization="Bearer ".concat(t)),console.log("[API Client] Cloning voice");let o=await fetch("".concat(r,"/api/voices/elevenlabs/clone"),{method:"POST",headers:s,body:e,credentials:"include"}),l=await o.json();if(!o.ok)throw new a(i(l)||"Voice cloning failed",o.status,l);return l}},c={list:async()=>o("/api/singers"),get:async e=>o("/api/singers/".concat(e)),create:async e=>o("/api/singers",{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>o("/api/singers/".concat(e),{method:"PUT",body:JSON.stringify(t)}),delete:async e=>o("/api/singers/".concat(e),{method:"DELETE"})},d={me:async()=>o("/api/auth/me"),logout:async()=>o("/api/auth/logout",{method:"POST"})},u={getUsage:async()=>o("/api/users/usage"),getQuota:async()=>o("/api/users/me/quota")},g={async list(e){let t=new URLSearchParams;(null==e?void 0:e.type)&&t.set("type",e.type),(null==e?void 0:e.singerId)&&t.set("singerId",e.singerId),(null==e?void 0:e.limit)&&t.set("limit",e.limit.toString()),(null==e?void 0:e.offset)&&t.set("offset",e.offset.toString());let s=t.toString();return o("/api/assets".concat(s?"?".concat(s):""))},get:async e=>o("/api/assets/".concat(e)),delete:async e=>o("/api/assets/".concat(e),{method:"DELETE"}),getStats:async()=>o("/api/assets/stats")},m={async list(e){let t=new URLSearchParams;(null==e?void 0:e.status)&&t.set("status",e.status),(null==e?void 0:e.type)&&t.set("type",e.type),(null==e?void 0:e.singerId)&&t.set("singerId",e.singerId),(null==e?void 0:e.limit)&&t.set("limit",e.limit.toString()),(null==e?void 0:e.offset)&&t.set("offset",e.offset.toString());let s=t.toString();return o("/api/jobs".concat(s?"?".concat(s):""))},get:async e=>o("/api/jobs/".concat(e)),delete:async e=>o("/api/jobs/".concat(e),{method:"DELETE"}),retry:async e=>o("/api/jobs/".concat(e,"/retry"),{method:"POST"}),getStats:async()=>o("/api/jobs/stats")},h={createSong:async e=>o("/api/music/songs",{method:"POST",body:JSON.stringify(e)}),async listSongs(e){let t=new URLSearchParams;(null==e?void 0:e.singerId)&&t.set("singerId",e.singerId),(null==e?void 0:e.status)&&t.set("status",e.status),(null==e?void 0:e.limit)&&t.set("limit",e.limit.toString()),(null==e?void 0:e.offset)&&t.set("offset",e.offset.toString());let s=t.toString();return o("/api/music/songs".concat(s?"?".concat(s):""))},getSong:async e=>o("/api/music/songs/".concat(e)),updateLyrics:async(e,t)=>o("/api/music/songs/".concat(e,"/lyrics"),{method:"POST",body:JSON.stringify(t)}),updateStructure:async(e,t)=>o("/api/music/songs/".concat(e,"/structure"),{method:"POST",body:JSON.stringify(t)}),generateVersion:async(e,t)=>o("/api/music/songs/".concat(e,"/generate"),{method:"POST",body:JSON.stringify(t)}),activateVersion:async(e,t)=>o("/api/music/songs/".concat(e,"/versions/").concat(t,"/activate"),{method:"POST"}),deleteSong:async e=>o("/api/music/songs/".concat(e),{method:"DELETE"})}},4564:(e,t,s)=>{Promise.resolve().then(s.bind(s,5091))},5091:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var r=s(5155),a=s(2115),i=s(2327),n=s(1640);function o(){let[e,t]=(0,a.useState)([]),[s,o]=(0,a.useState)([]),[l,c]=(0,a.useState)(!0),[d,u]=(0,a.useState)(!1),[g,m]=(0,a.useState)(!1),[h,p]=(0,a.useState)(!1),[f,x]=(0,a.useState)(""),[v,y]=(0,a.useState)(""),[j,b]=(0,a.useState)(""),[S,N]=(0,a.useState)("premade"),[w,P]=(0,a.useState)(""),[k,I]=(0,a.useState)(""),[E,C]=(0,a.useState)(""),[T,A]=(0,a.useState)(""),[O,V]=(0,a.useState)(""),[J,U]=(0,a.useState)(""),[L,_]=(0,a.useState)(""),[q,D]=(0,a.useState)("");async function R(){try{let[e,s]=await Promise.all([i.Me.list(),i.qT.listVoices()]);t(e.singers||[]),o(s.voices||[]),c(!1)}catch(e){console.error("[Singers Page] Load error:",e),_(e instanceof Error?e.message:"Failed to load data"),c(!1)}}async function z(){if(!k.trim())return void _("Please enter a voice description");m(!0),_(""),D("");try{console.log("[Singers Page] Generating voice with description:",k);let e=await i.qT.generateVoice({name:f||"Custom Voice",description:k});console.log("[Singers Page] Voice generated successfully:",e),C(e.voice_id),A(e.preview_url),D("Voice generated successfully! You can now create your singer.")}catch(e){console.error("[Singers Page] Voice generation error:",e),e instanceof i.u5?403===e.status?_("Voice generation requires a premium plan. Please upgrade your account."):422===e.status?_("Invalid voice description. Please provide more detail."):_(e.message||"Failed to generate voice"):_("An unexpected error occurred. Please try again.")}finally{m(!1)}}async function G(){if(!O.trim())return void _("Please enter an image description");p(!0),_(""),D("");try{console.log("[Singers Page] Generating image with prompt:",O);let e=await fetch("https://ai-singer-studio-production.ivanleejackson.workers.dev/api/generate/image",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("auth_token"))},body:JSON.stringify({prompt:O,name:f||"Singer Profile"})});if(!e.ok)throw Error("Image generation failed: ".concat(e.statusText));let t=await e.json();console.log("[Singers Page] Image generated successfully:",t),U(t.url||t.imageUrl||t.image_url),D("Image generated successfully! Preview below.")}catch(e){console.error("[Singers Page] Image generation error:",e),_(e instanceof Error?e.message:"Failed to generate image")}finally{p(!1)}}async function Y(e){if(e.preventDefault(),!f.trim())return void _("Singer name is required");if("premade"===S&&!w)return void _("Please select a voice");if("ai-generated"===S&&!E)return void _("Please generate a voice first");u(!0),_(""),D("");try{let e="premade"===S?w:E;await i.Me.create({name:f,description:v,genre:j,voiceSettings:{voiceId:e,type:S},profileImageUrl:J||null}),D("Singer created successfully!"),x(""),y(""),b(""),I(""),P(""),C(""),A(""),V(""),U(""),await R()}catch(e){console.error("[Singers Page] Create error:",e),_(e instanceof Error?e.message:"Failed to create singer")}finally{u(!1)}}return((0,a.useEffect)(()=>{R()},[]),l)?(0,r.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,r.jsx)(n.tK,{size:"lg",className:"text-primary"})}):(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsx)(n._A,{children:(0,r.jsx)("div",{className:"flex justify-between items-center",children:(0,r.jsx)(n.DZ,{as:"h1",children:"My Singers"})})}),L&&(0,r.jsx)(n.YE,{children:(0,r.jsx)(n.Zp,{variant:"default",className:"border-error-200 bg-error-50",children:(0,r.jsx)(n.Wu,{className:"p-4",children:(0,r.jsx)(n.EY,{className:"text-error-700",children:L})})})}),q&&(0,r.jsx)(n.YE,{children:(0,r.jsx)(n.Zp,{variant:"default",className:"border-success-200 bg-success-50",children:(0,r.jsx)(n.Wu,{className:"p-4",children:(0,r.jsx)(n.EY,{className:"text-success-700",children:q})})})}),(0,r.jsx)(n.FQ,{direction:"bottom",children:(0,r.jsxs)(n.Zp,{variant:"glass",children:[(0,r.jsx)(n.aR,{children:(0,r.jsx)(n.ZB,{children:"Create New Singer"})}),(0,r.jsx)(n.Wu,{children:(0,r.jsxs)("form",{onSubmit:Y,className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(n.JU,{required:!0,children:"Singer Name"}),(0,r.jsx)(n.pd,{type:"text",value:f,onChange:e=>x(e.target.value),placeholder:"e.g., Luna",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(n.JU,{children:"Genre"}),(0,r.jsx)(n.pd,{type:"text",value:j,onChange:e=>b(e.target.value),placeholder:"e.g., Pop, Rock, Jazz"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(n.JU,{children:"Description"}),(0,r.jsx)(n.TM,{value:v,onChange:e=>y(e.target.value),rows:3,placeholder:"Describe your singer..."})]}),(0,r.jsxs)("div",{className:"border-t border-border pt-6",children:[(0,r.jsx)(n.DZ,{as:"h3",className:"mb-4 text-slate-900",children:"Voice Selection"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex space-x-4",children:[(0,r.jsx)(n.$n,{type:"button",onClick:()=>N("premade"),variant:"premade"===S?"primary":"outline",size:"md",children:"Premade Voices"}),(0,r.jsx)(n.$n,{type:"button",onClick:()=>N("ai-generated"),variant:"ai-generated"===S?"primary":"outline",size:"md",children:"AI Voice Generation"})]}),"premade"===S&&(0,r.jsxs)("div",{children:[(0,r.jsx)(n.JU,{children:"Select Voice"}),(0,r.jsxs)("select",{value:w,onChange:e=>P(e.target.value),className:"w-full px-3 py-2 border border-border bg-background text-foreground rounded-md focus:outline-none focus:ring-2 focus:ring-primary transition-all duration-fast",children:[(0,r.jsx)("option",{value:"",children:"Choose a voice..."}),s.map(e=>{var t;return(0,r.jsxs)("option",{value:e.voice_id,children:[e.name," ",(null==(t=e.labels)?void 0:t.accent)&&"(".concat(e.labels.accent,")")]},e.voice_id)})]})]}),"ai-generated"===S&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(n.JU,{children:"Voice Description"}),(0,r.jsx)(n.TM,{value:k,onChange:e=>I(e.target.value),rows:3,placeholder:"Describe the voice you want to generate (e.g., warm soulful urban female voice)"})]}),(0,r.jsx)(n.$n,{type:"button",onClick:z,disabled:g||!k.trim(),loading:g,variant:"primary",size:"md",children:g?"Generating Voice...":"Generate Custom Voice"}),T&&(0,r.jsx)(n.YE,{children:(0,r.jsx)(n.Zp,{variant:"default",className:"border-success-200 bg-success-50",children:(0,r.jsxs)(n.Wu,{className:"p-4",children:[(0,r.jsx)(n.EY,{className:"text-success-700 mb-2",children:"✓ Voice generated successfully! Preview:"}),(0,r.jsx)("audio",{controls:!0,src:"data:audio/mp3;base64,".concat(T),className:"w-full"})]})})})]})]})]}),(0,r.jsxs)("div",{className:"border-t border-border pt-6",children:[(0,r.jsx)(n.DZ,{as:"h3",className:"mb-4 text-slate-900",children:"Profile Image (Optional)"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(n.JU,{children:"Image Description"}),(0,r.jsx)(n.TM,{value:O,onChange:e=>V(e.target.value),rows:3,placeholder:"Describe the singer's appearance (e.g., professional headshot of a female pop singer with long dark hair, studio lighting)"}),(0,r.jsx)(n.EE,{children:"Generate an AI image for your singer's profile. Leave blank to skip."})]}),(0,r.jsx)(n.$n,{type:"button",onClick:G,disabled:h||!O.trim(),loading:h,variant:"outline",size:"md",children:h?"Generating Image...":"Generate Profile Image"}),J&&(0,r.jsx)(n.YE,{children:(0,r.jsx)(n.Zp,{variant:"default",className:"border-success-200 bg-success-50",children:(0,r.jsxs)(n.Wu,{className:"p-4",children:[(0,r.jsx)(n.EY,{className:"text-success-700 mb-3",children:"✓ Profile image generated successfully!"}),(0,r.jsx)("div",{className:"rounded-xl overflow-hidden shadow-lg",children:(0,r.jsx)("img",{src:J,alt:"Generated singer profile",className:"w-full h-auto max-h-96 object-cover"})})]})})})]})]}),(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsx)(n.$n,{type:"submit",disabled:d,loading:d,variant:"primary",size:"lg",children:d?"Creating Singer...":"Create Singer"})})]})})]})}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("h2",{className:"text-2xl font-bold text-slate-900 flex items-center gap-3",children:[(0,r.jsx)("div",{className:"w-1 h-8 bg-gradient-to-b from-violet-600 to-fuchsia-600 rounded-full"}),"Your Singers"]}),(0,r.jsxs)(n.EY,{variant:"muted",children:[e.length," total"]})]}),0===e.length?(0,r.jsxs)("div",{className:"rounded-2xl bg-white/70 backdrop-blur-xl p-12 border border-slate-200/50 shadow-lg text-center",children:[(0,r.jsx)("div",{className:"w-20 h-20 mx-auto mb-6 rounded-full bg-gradient-to-br from-violet-100 to-fuchsia-100 flex items-center justify-center",children:(0,r.jsx)("svg",{className:"w-10 h-10 text-violet-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})})}),(0,r.jsx)("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:"No singers yet"}),(0,r.jsx)("p",{className:"text-slate-600 mb-6",children:"Create your first AI singer to start generating content"})]}):(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(e=>{var t;return(0,r.jsxs)("a",{href:"/dashboard/singers/profile?id=".concat(e.id),className:"group relative overflow-hidden rounded-2xl bg-white/70 backdrop-blur-xl p-6 border border-slate-200/50 hover:border-violet-300 shadow-lg hover:shadow-2xl transition-all duration-500 hover:scale-105 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-violet-600",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-violet-600/10 to-fuchsia-600/10 opacity-0 group-hover:opacity-100 transition-opacity duration-500"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 rounded-2xl bg-gradient-to-br from-violet-600 to-fuchsia-600 flex items-center justify-center text-white text-2xl font-bold shadow-lg shadow-violet-500/40 group-hover:shadow-xl group-hover:shadow-violet-500/60 transition-all duration-500 group-hover:scale-110",children:(null==(t=e.name[0])?void 0:t.toUpperCase())||"S"}),(0,r.jsxs)("div",{className:"text-center mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-bold text-slate-900 mb-1 group-hover:text-violet-700 transition-colors duration-300",children:e.name}),e.genre&&(0,r.jsx)("span",{className:"inline-block px-3 py-1 rounded-full text-xs font-semibold bg-violet-100 text-violet-700",children:e.genre})]}),e.description&&(0,r.jsx)("p",{className:"text-sm text-slate-600 text-center line-clamp-2 mb-4",children:e.description}),(0,r.jsxs)("div",{className:"flex items-center justify-center gap-4 pt-4 border-t border-slate-200/50",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("p",{className:"text-xs font-medium text-slate-700",children:"Videos"}),(0,r.jsx)("p",{className:"text-sm font-bold text-slate-900",children:"0"})]}),(0,r.jsx)("div",{className:"w-px h-8 bg-slate-200"}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("p",{className:"text-xs font-medium text-slate-700",children:"Images"}),(0,r.jsx)("p",{className:"text-sm font-bold text-slate-900",children:"0"})]}),(0,r.jsx)("div",{className:"w-px h-8 bg-slate-200"}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("p",{className:"text-xs font-medium text-slate-700",children:"Audio"}),(0,r.jsx)("p",{className:"text-sm font-bold text-slate-900",children:"0"})]})]}),(0,r.jsx)("div",{className:"absolute top-4 right-4 w-8 h-8 rounded-full bg-white/80 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:(0,r.jsx)("svg",{className:"w-4 h-4 text-violet-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})]},e.id)})})]})]})}}},e=>{e.O(0,[640,441,255,358],()=>e(e.s=4564)),_N_E=e.O()}]);