(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[502],{63:(e,t,s)=>{"use strict";var r=s(7260);s.o(r,"useParams")&&s.d(t,{useParams:function(){return r.useParams}}),s.o(r,"usePathname")&&s.d(t,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(t,{useSearchParams:function(){return r.useSearchParams}})},2327:(e,t,s)=>{"use strict";s.d(t,{Me:()=>l,R2:()=>u,eM:()=>g,ic:()=>h,lu:()=>d,qT:()=>c,u5:()=>n,vS:()=>m});let r="https://ai-singer-studio-production.ivanleejackson.workers.dev";class n extends Error{constructor(e,t,s){super(e),this.status=t,this.data=s,this.name="APIClientError"}}function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Set;if("string"==typeof e)return e;if(!e)return"Request failed";if("object"==typeof e&&t.has(e))return"Request failed (circular reference)";if("object"==typeof e&&t.add(e),"string"==typeof e.message)return e.message;if("string"==typeof e.error)return e.error;if("string"==typeof e.error_description)return e.error_description;if("string"==typeof e.detail)return e.detail;if(Array.isArray(e.errors)){let t=e.errors.map(e=>e.message||e.error||"Unknown error").filter(e=>"string"==typeof e);if(t.length>0)return t.join(", ")}if(Array.isArray(e.issues))return e.issues.map(e=>e.message?e.message:Array.isArray(e.path)&&e.path.length?"".concat(e.path.join("."),": ").concat(e.message||"Invalid value"):"Validation error").join(", ");if(Array.isArray(e)){let s=e.map(e=>"string"==typeof e?e:a(e,t)).filter(e=>e&&"Request failed"!==e);if(s.length>0)return s.join(", ")}if("object"==typeof e.error&&null!==e.error)return a(e.error,t);if("object"==typeof e.message&&null!==e.message)return a(e.message,t);if(e.details)return"string"==typeof e.details?e.details:JSON.stringify(e.details);try{let t=JSON.stringify(e);return t.length>200?t.substring(0,200)+"...":t}catch(e){return"Request failed"}}function i(){let e=localStorage.getItem("token")||localStorage.getItem("authToken")||sessionStorage.getItem("token");return console.log("[API Client] Token found:",!!e),e}async function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=i(),o={"Content-Type":"application/json",...t.headers};s&&(o.Authorization="Bearer ".concat(s));let c="".concat(r).concat(e);console.log("[API Client] Request:",t.method||"GET",c);try{let e,s=await fetch(c,{...t,headers:o,credentials:"include"}),r=s.headers.get("content-type"),i=await s.text();if(i)if((null==r?void 0:r.includes("application/json"))||i.trim().startsWith("{")||i.trim().startsWith("["))try{e=JSON.parse(i)}catch(t){e={message:i}}else e={message:i};else e=null;if(!s.ok)throw console.error("[API Client] Error response:",{status:s.status,contentType:r,data:e}),new n(e?a(e):"Request failed with status ".concat(s.status),s.status,e);return console.log("[API Client] Success:",e),e}catch(e){if(e instanceof n)throw e;throw console.error("[API Client] Network error:",e),new n(e instanceof Error?e.message:"Network error occurred")}}let c={async listVoices(e){let t=e?"?category=".concat(encodeURIComponent(e)):"";return o("/api/voices/elevenlabs".concat(t))},getVoice:async e=>o("/api/voices/elevenlabs/".concat(e)),generateVoice:async e=>(console.log("[API Client] Generating voice with params:",e),o("/api/voices/elevenlabs/generate",{method:"POST",body:JSON.stringify(e)})),async cloneVoice(e){let t=i(),s={};t&&(s.Authorization="Bearer ".concat(t)),console.log("[API Client] Cloning voice");let o=await fetch("".concat(r,"/api/voices/elevenlabs/clone"),{method:"POST",headers:s,body:e,credentials:"include"}),c=await o.json();if(!o.ok)throw new n(a(c)||"Voice cloning failed",o.status,c);return c}},l={list:async()=>o("/api/singers"),get:async e=>o("/api/singers/".concat(e)),create:async e=>o("/api/singers",{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>o("/api/singers/".concat(e),{method:"PUT",body:JSON.stringify(t)}),delete:async e=>o("/api/singers/".concat(e),{method:"DELETE"})},u={me:async()=>o("/api/auth/me"),logout:async()=>o("/api/auth/logout",{method:"POST"})},d={getUsage:async()=>o("/api/users/usage"),getQuota:async()=>o("/api/users/me/quota")},g={async list(e){let t=new URLSearchParams;(null==e?void 0:e.type)&&t.set("type",e.type),(null==e?void 0:e.singerId)&&t.set("singerId",e.singerId),(null==e?void 0:e.limit)&&t.set("limit",e.limit.toString()),(null==e?void 0:e.offset)&&t.set("offset",e.offset.toString());let s=t.toString();return o("/api/assets".concat(s?"?".concat(s):""))},get:async e=>o("/api/assets/".concat(e)),delete:async e=>o("/api/assets/".concat(e),{method:"DELETE"}),getStats:async()=>o("/api/assets/stats")},m={async list(e){let t=new URLSearchParams;(null==e?void 0:e.status)&&t.set("status",e.status),(null==e?void 0:e.type)&&t.set("type",e.type),(null==e?void 0:e.singerId)&&t.set("singerId",e.singerId),(null==e?void 0:e.limit)&&t.set("limit",e.limit.toString()),(null==e?void 0:e.offset)&&t.set("offset",e.offset.toString());let s=t.toString();return o("/api/jobs".concat(s?"?".concat(s):""))},get:async e=>o("/api/jobs/".concat(e)),delete:async e=>o("/api/jobs/".concat(e),{method:"DELETE"}),retry:async e=>o("/api/jobs/".concat(e,"/retry"),{method:"POST"}),getStats:async()=>o("/api/jobs/stats")},h={createSong:async e=>o("/api/music/songs",{method:"POST",body:JSON.stringify(e)}),async listSongs(e){let t=new URLSearchParams;(null==e?void 0:e.singerId)&&t.set("singerId",e.singerId),(null==e?void 0:e.status)&&t.set("status",e.status),(null==e?void 0:e.limit)&&t.set("limit",e.limit.toString()),(null==e?void 0:e.offset)&&t.set("offset",e.offset.toString());let s=t.toString();return o("/api/music/songs".concat(s?"?".concat(s):""))},getSong:async e=>o("/api/music/songs/".concat(e)),updateLyrics:async(e,t)=>o("/api/music/songs/".concat(e,"/lyrics"),{method:"POST",body:JSON.stringify(t)}),updateStructure:async(e,t)=>o("/api/music/songs/".concat(e,"/structure"),{method:"POST",body:JSON.stringify(t)}),generateVersion:async(e,t)=>o("/api/music/songs/".concat(e,"/generate"),{method:"POST",body:JSON.stringify(t)}),activateVersion:async(e,t)=>o("/api/music/songs/".concat(e,"/versions/").concat(t,"/activate"),{method:"POST"}),deleteSong:async e=>o("/api/music/songs/".concat(e),{method:"DELETE"})}},2921:(e,t,s)=>{Promise.resolve().then(s.bind(s,7782))},7782:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var r=s(5155),n=s(2115),a=s(63),i=s(2327),o=s(1640);function c(){let e=(0,a.useRouter)(),t=(0,a.useSearchParams)(),[s,c]=(0,n.useState)(""),[l,u]=(0,n.useState)(!1),[d,g]=(0,n.useState)(""),m=(null==t?void 0:t.get("redirect"))||"/dashboard/singers";async function h(t){t.preventDefault(),u(!0),g("");try{if(localStorage.setItem("token",s),(await i.R2.me()).authenticated)e.push(m);else throw Error("Authentication failed")}catch(e){console.error("[Sign In] Error:",e),g("Invalid token. Please check and try again."),localStorage.removeItem("token")}finally{u(!1)}}return(0,n.useEffect)(()=>{let e=new URLSearchParams(window.location.search).get("token");e&&c(e)},[]),(0,r.jsx)(o.gc,{children:(0,r.jsxs)("div",{className:"min-h-screen flex items-center justify-center bg-background relative overflow-hidden px-4",children:[(0,r.jsx)(o.fO,{className:"absolute inset-0 opacity-30"}),(0,r.jsx)("div",{className:"max-w-md w-full relative z-10",children:(0,r.jsx)(o._A,{children:(0,r.jsx)(o.Zp,{variant:"glass",children:(0,r.jsxs)(o.Wu,{className:"p-8",children:[(0,r.jsxs)("div",{className:"text-center mb-8",children:[(0,r.jsx)(o.DZ,{as:"h1",className:"mb-2",children:(0,r.jsx)(o.yR,{children:"AI Singer Studio"})}),(0,r.jsx)(o.EY,{variant:"muted",children:"Sign in to continue"})]}),(0,r.jsxs)("form",{onSubmit:h,className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(o.JU,{required:!0,children:"Access Token"}),(0,r.jsx)(o.pd,{type:"text",value:s,onChange:e=>c(e.target.value),placeholder:"Enter your access token",required:!0}),(0,r.jsx)(o.EE,{children:"Use format: test-token-yourname or your user ID"})]}),d&&(0,r.jsx)(o.YE,{children:(0,r.jsx)(o.Zp,{variant:"default",className:"border-error-200 bg-error-50",children:(0,r.jsx)(o.Wu,{className:"p-4",children:(0,r.jsx)(o.EY,{className:"text-error-700",children:d})})})}),(0,r.jsx)(o.YE,{delay:100,children:(0,r.jsx)(o.$n,{type:"submit",disabled:l||!s,loading:l,variant:"primary",size:"lg",fullWidth:!0,children:l?"Signing in...":"Sign In"})})]}),(0,r.jsx)("div",{className:"mt-6 text-center",children:(0,r.jsxs)(o.EY,{size:"sm",variant:"muted",children:["Don't have an account?"," ",(0,r.jsx)(o.N_,{href:"/sign-up",variant:"default",children:"Sign up"})]})}),(0,r.jsxs)("div",{className:"mt-8 pt-6 border-t border-border",children:[(0,r.jsx)(o.EE,{className:"mb-3",children:"Quick Test Access:"}),(0,r.jsx)(o.$n,{type:"button",onClick:()=>c("7d6c9c2e47f8e06d83c5d745187e9c8c8c85b131764f05abab786fb4bde3295c"),variant:"ghost",size:"sm",fullWidth:!0,children:"Use Production Token"})]})]})})})})]})})}function l(){return(0,r.jsx)(n.Suspense,{fallback:(0,r.jsxs)("div",{className:"min-h-screen flex items-center justify-center bg-background relative overflow-hidden",children:[(0,r.jsx)(o.fO,{className:"absolute inset-0 opacity-30"}),(0,r.jsx)("div",{className:"relative z-10",children:(0,r.jsx)(o.tK,{size:"lg",className:"text-primary"})})]}),children:(0,r.jsx)(c,{})})}}},e=>{e.O(0,[640,441,255,358],()=>e(e.s=2921)),_N_E=e.O()}]);